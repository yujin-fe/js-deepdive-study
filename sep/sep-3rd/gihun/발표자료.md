# 9월 3주차 발표자료~

## 생성자 함수

1. 생성자 함수 정의

+ 생성자함수:new 연산자와 함께 호출되어 객체를 생성하는 함수 

### 규칙

+ 생성자 함수 이름은 대문자로 시작
+ 반드시 new와 함께 호출해야 의도한 대로 동작

```
// 일반 함수
function normalFunc() {
  console.log("나는 그냥 함수!");
}

// 생성자 함수
function Circle(radius) {
  this.radius = radius;
  this.draw = function() {
    console.log("원의 반지름:", this.radius);
  };
}

normalFunc();         // 그냥 실행됨
const c = new Circle(10);
c.draw();             // 원의 반지름: 10

```
### 새롭게 생긴 메모리와 Circle 메모리안에 bits 값은 동일하기에 이런 결과가 나오는것인가?

### 아닙니다~ 밑에 정리는 new연산자의 내부동작을 쉽게 풀어서 정리입니다~

Circle 함수는 설계도 
```
const c = new Circle(10)
```
코드는 설계도(Circle)를 가지고 새로운 아파트 건물(c)하나를 지으라는 명령

1. 메모리 할당(땅 구매): 노동자(new) 가 새로운 아파트를 지을 땅을 확보

2. 객체생성 및 초기화(건물 건설): 설계도(Circle)에 따라 이 땅 위에 새로운 아파트건물(빈객체{})이 지어지고 'radius:10',draw 라는 방과 기능이 추가됨

3. 참조반환(주소지 등록): 건물이 다 지어지면,이 아파트 건물이 어디에 있는지 정확한 주소(메모리 주소) 가 생성됨

4. 변수 저장(명함에 주소기록): 메모리주소가 c 라는 종이에 적혀서 저장됨

설계도와 아파트 건물은 다릅니다~~ 

[[Call]] VS [[Construct]]

+ 모든 함수 객체는 내부 메서드 [[Call]] 을 가짐
+ 생성자 함수는 [[Construct]]도 가짐

constructor 함수 

+ 선언문 function
+ 함수 표현식 

non constructor 함수

+ 화살표 함수 () => {}
+ ES6 메서드 축약 표현

## new.target

+ 함수 내부에서 new와 함께 호출되었는지 확인

+ new.target이 undefined-> 그냥 호출

+ new.target이 함수 자신 -> new로 호출

```function Circle(radius) {
  if (!new.target) {
    return new Circle(radius); // new 없이 호출해도 new 붙여줌
  }
  this.radius = radius;
}

const c1 = Circle(10);   // new 안 붙였는데도 자동 보정
const c2 = new Circle(20);

console.log(c1); // Circle { radius: 10 }
console.log(c2); // Circle { radius: 20 }

```

new.target 의 기능 

함수가 new키워드로 호출되었는지 여부를 확인

```
const c1 = Circle
```
new 없이 호출이 되었기 때문에 

if (!new.target) -> if (!undefined)

undefined의 부정은 true

그래서 if문이 동작함

### 여기는 다같이 의견을 나누어 보아요~
그러면 어떤일이 벌어질까요?

if블록 안의 코드가 실행이 되면서 new가 붙은 상태로 함수가 실행이 됩니다

새로운 호출에서는 new.target이 Circle ㅎ마수를 가리키므로 if문의 조건은 false가 되서 
if코드블록 바깥의 코드가 동작합니다 

## new 없이 호출했을때의 문제 


```function Circle(radius) {
  this.radius = radius;
}

// new 없이 호출
const c = Circle(15);

console.log(c);          // undefined
console.log(globalThis); // globalThis.radius = 15 (❌ 전역 오염!)

```
const c = Circle(15);

+ new 키워드 없이 Circle 함수를 호출했습니다.

+ 일반 함수처럼 호출되면, 함수가 반환하는 값이 없으므로 c에는 **undefined**가 할당됩니다. 따라서 console.log(c)는 undefined를 출력합니다.
